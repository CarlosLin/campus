<!DOCTYPE html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
</head>
<title>
    Sell
</title>
<body>
<div>
    <div>
      <form name=data>
<%= simple_form_for @auction, html: {class: 'form-horizobtal', multipart: true } do |f| %>
    <%= f.input :item_name, :label => "名稱" %>
    <%= f.input :narrative, :as => :text, :label => "描述" %>
    <br>
    <label>數量</label>
    </br>
    <%= f.input_field :quantity, :label => "數量" %>
    <%= f.input :price, as: :string, :label => "價格" %>
    <div class="row">
        <div class="col-md-3">
            <%= file_field_tag "images[]", type: :file, multiple: true %>
        <br>    
        </div>
    </div>
    </div>
    <div class="row">
    <div class="col-md-3">
    <%= select_tag "root", options_from_collection_for_select(@cate_roots, "id", "category_name"), :prompt => "請選擇主要分類", :onchange => "sub_cate(this.value)" %>
    <%= select_tag "category", 'value to check if exist in the list', 
            {:include_blank => "請先選擇主要分類"}%>
        <!-- <select name=cate onChange=sub_cate(this.value);>
        <%@cate_roots.each do |c|%>
          <option value="<%=c.id%>"><%=c.category_name%></option>
        <%end%>
  </select> -->
  <!-- <div class="field">
  <%= f.label :root %><br>
    <%= f.select(:id, {id: 'cate_root'}) do %>
      <% @cate_roots.each do |c| -%>
        <%= content_tag(:option, c.category_name, value: c.id) %>
      <% end %>
    <% end %>
  </div> -->
  <!-- <div class="field">
  <%= f.label :category %><br>
    <%= f.select(:id, @sub_categories, {id: 'sub_cate'}) %>

  </div> -->
    </div>
    </div>

    <br>
    <script type="text/javascript">

    function sub_cate(value){
    $.ajax({
      type: "GET",
      url: '/admin/sub_cate?id='+value,
      data: 'text',
      success: function(data){
        $("#category").html(data);
      }
    })
  }
      $(document).ready(function(){
        $('#cate_root').change(function(){
        var parent_id = $("#cate_root").val();
        $.get("<%= auctions_path %>",
        { parent_id: parent_id },
        function(data){ }
      );
    }); 
    }); 
      </script>

    <div class="row">
    <div class="col-md-1">
    <button type="submit" class="btn btn-default">Create</button>
    </div>
    <div class="col-md-1 ">
    <%= link_to "Cancel", auctions_path, class: " btn btn-default" %>
    </div>
    </div>
  <% end %>
  </form>
</div>
</body>